<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="TLEprediction : Predict seizure onset laterality in temporal lobe epilepsy">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>TLEprediction</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/dorianps/TLEprediction">View on GitHub</a>

          <h1 id="project_title">TLEprediction</h1>
          <h2 id="project_tagline">Predict seizure onset laterality in temporal lobe epilepsy</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/dorianps/TLEprediction/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/dorianps/TLEprediction/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>Note, training data are now available.</p>

<h1>
<a id="prediction-of-seizure-laterality" class="anchor" href="#prediction-of-seizure-laterality" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prediction of seizure laterality</h1>

<p>This project provides the tools and necessary data to predict the laterality of seizure onset in new temporal lobe epilepsy patients based on 3 PET asymmetries. The prediciton is done in two steps: obtain the asymmetries in Matlab (part 1) and use the values to classify the patient in R (part 2).  </p>

<p>Requirements:</p>

<ul>
<li>Parcellation of T1 with Freesurfer (sorry, can't avoid this)</li>
<li>A working <a href="http://www.mathworks.com/products/matlab/">Matlab</a> with <a href="http://www.fil.ion.ucl.ac.uk/spm/software/download.html">SPM8</a> </li>
<li>
<a href="http://www.r-project.org/">R</a> or, even better, <a href="http://www.rstudio.com/products/rstudio/download/">Rstudio</a> </li>
</ul>

<h2>
<a id="part-1-obtain-3-pet-asymmetries" class="anchor" href="#part-1-obtain-3-pet-asymmetries" aria-hidden="true"><span class="octicon octicon-link"></span></a>PART 1: obtain 3 PET asymmetries</h2>

<p>Download <a href="https://github.com/dorianps/TLEprediction/archive/master.zip">all files</a> and add the folder into the Matlab path. Write the command <code>CalculatePETasymmetries</code> (case sensitive). The script will ask you for three files:<br>
1. PET volume (i.e., PET.nii)<br>
2. MRI volume (i.e. 001.nii)<br>
3. Parcellation from Freesurfer (i.e., wmparc.nii)<br>
<em>Note: the process relies on SPM8 functions, other SPM versions not tested.</em>  </p>

<p>The script will coregister PET on MRI and reslice the parcellation. It is assumed that the MRI and parcellation volumes are already registered, and that PET and MRI have the same initial orientation.<br>
The smoothed masks will be computed and saved in the PET folder. Finally, the three asymmetries are computed and displayed.<br>
PLEASE DOUBLE CHECK THAT PET HAS BEEN WELL COREGISTERED ONTO MRI !</p>

<h2>
<a id="part-2-classify-the-patient" class="anchor" href="#part-2-classify-the-patient" aria-hidden="true"><span class="octicon octicon-link"></span></a>PART 2: classify the patient</h2>

<p>The R script is fully automated and requires only the three asymmetry values obtained in Matlab.  </p>

<p><strong>QUICK USAGE:</strong><br>
(Windows):<br>
<code>source('https://raw.githubusercontent.com/dorianps/TLEprediction/master/TLEpredict.R', echo=F)</code>  </p>

<p>(Linux/Mac)<br>
Install RCurl the first time: <code>install.packages("RCurl")</code><br>
Then run command:<br>
<code>library(RCurl) ; eval( expr = parse( text = getURL("https://raw.githubusercontent.com/dorianps/TLEprediction/master/TLEpredict.R", ssl.verifypeer=FALSE) ))</code>  </p>

<p>Enter the values obtained in Matlab and get the classification statistics.  </p>

<p><strong>OFFLINE USAGE:</strong><br>
Run the file <a href="https://raw.githubusercontent.com/dorianps/TLEprediction/master/TLEpredict.R">TLEpredict.R</a> in R and follow the instructions.  </p>

<hr>

<p><strong>NOTES</strong><br>
The required <code>brglm</code> package will be automatically installed if not present in your R libraries.<br>
The script will automatically stop if asymmetry values entered are out of [-1 1] range, and will warn if values entered are out of the TLE population range.</p>

<hr>

<p><strong>QUESTIONS</strong>  </p>

<blockquote>
<p><strong>Why is Freesurfer parcellation needed?</strong><br>
<em>To know where to look in the PET image and get the right asymmetries of signal and signal variance.</em><br>
<strong>How can I get the parcellation from Freesurfer?</strong><br>
<em>Check the <a href="https://surfer.nmr.mgh.harvard.edu/fswiki/FreeSurferBeginnersGuide">Freesurfer Beginner guide</a>. Once you install Freesurfer, a command like</em><br>
<code>recon-all -i T1.nii -s JohnB -sd /home/Freesurfer/ -all</code><br>
<em>will output the analysis of T1.nii in a folder named JohnB in /home/Freesurfer/. The wmparc file is what you need, convert it to niftii if necessary</em><br>
<code>mri_convert --in_type mgz --out_type nii --out_orientation RAS /home/Freesurfer/JohnB/mri/wmparc.mgz</code><br>
<strong>Why can't you do everything in Matlab or everything in R?</strong><br>
<em>R can easily run penalized logistic regression, but has limited resources for image processing.</em><br>
<em>Matlab can do image processing through SPM, but has limited resources for penalized regression.</em><br>
<em>Unifying the pipeline might be an option for the future.</em><br>
<strong>When will the training data be available?</strong><br>
<em>The training data is available since July 1, 2015</em>  </p>
</blockquote>

<hr>

<p><strong>PREDICTION EXAMPLE:</strong><br>
<code>source('https://raw.githubusercontent.com/dorianps/TLEprediction/master/TLEpredict.R', echo=F)</code><br>
  Assymetry for PET-mesial: -0.037443<br>
  Assymetry for PET-hippo-var: 0.050887<br>
  Assymetry for PET-entire-var: 0.12806<br>
Number of bootstraps (i.e., 10000): 10000<br>
Exclude cases from training (0=none, 1=Engel class III/IV, 2=non-operated, 3=1+2): 0<br>
<em>Using 58 TLE patients for training (28 left)...</em>  </p>

<blockquote>
<p>|=============================================================| 100%<br>
 Patient Classification (10000 bootstraps):<br>
  [1] "left TLE: 1.48%"<br>
  [1] "right TLE: 98.52%"<br>
Average Posterior Probability (0=left, 1=right):<br>
  [1] 0.941<br>
95% CI of posterior probability (0.5=chance):<br>
   2.5% 97.5%<br>
  0.631 1.000   </p>
</blockquote>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">TLEprediction maintained by <a href="https://github.com/dorianps">dorianps</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
